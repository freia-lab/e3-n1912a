# Protocol file for Keysight N1912A power meter

Terminator = LF;

ReplyTimeout = 5000;

DELAY = 50;

#P = "HPRF-PwrMtr:";
#DEV = "N1912A";

get_id {
   out "*idn?";
   in "%#s";
   @init { out "*idn?";
   	 in "%#s"; }
}

get_err {
   out "syst:err?";
   in "%#s";
}


# query power

fetch_power {
   out "FETC\$1:POW:AC?";
   wait $DELAY;
   in "%f";
}

# query offset

fetch_offset {
   out "SENS\$1:CORR:GAIN2?";
   wait $DELAY;
   in "%f";
}

# set offset

set_offset {
   out "SENS\$1:CORR:GAIN2 %f";
}


# query channel offset for the power meter setup
# returns 0 or 1

get_offset_status {
   out "SENS\$1:CORR:GAIN2:STAT?";
   in "%i";
}

# enable/disable a channel offset for the power meter setup

set_offset_status {
   out "SENS\$1:CORR:GAIN2:STAT %i";
   @init { get_offset_status; }
}

